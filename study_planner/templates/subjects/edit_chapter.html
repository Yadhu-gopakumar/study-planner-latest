{% extends 'base.html' %}
{% block title %}Edit Chapter - {{ chapter.title }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto py-10">
    <div class="mb-10">
        <div class="flex items-center gap-3 mb-2">
            <a href="{% url 'subjects:subject_detail' chapter.subject.id %}" 
               class="text-[#6C5DD3] bg-white p-2 rounded-xl shadow-sm hover:scale-110 transition-transform">‚Üê</a>
            <h1 class="text-4xl font-extrabold text-indigo-900 tracking-tight">Edit Chapter {{ chapter.chapter_number }}</h1>
        </div>
        <p class="text-gray-500 ml-12">Update the title or study materials for this section.</p>
    </div>

    <div class="bg-white/70 backdrop-blur-xl border border-white/40 rounded-[2.5rem] p-10 shadow-2xl shadow-indigo-100">
        <form method="POST" enctype="multipart/form-data" class="space-y-8">
            {% csrf_token %}
            
            <div class="space-y-2">
                <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest ml-1">Chapter Title</label>
                <input type="text" name="title" value="{{ chapter.title }}" required 
                       class="w-full bg-white/80 border-2 border-indigo-50 px-6 py-4 rounded-2xl text-gray-700 outline-none focus:border-[#6C5DD3] transition-all">
            </div>

            <div class="space-y-2">
                <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest ml-1">Current Note</label>
                {% if chapter.note_file %}
                <div class="flex items-center justify-between p-4 bg-indigo-50/50 rounded-2xl border border-indigo-100 mb-2">
                    <span class="text-indigo-900 text-sm font-medium truncate max-w-[400px]">
                        üìÑ {{ chapter.note_file.name }}
                    </span>
                </div>
                {% endif %}
                
                <div class="relative group mt-4">
                    <input type="file" name="note_file" id="edit-file-input" accept=".pdf,.doc,.docx" 
                           class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10">
                    <div id="edit-drop-zone" class="bg-white border-2 border-dashed border-indigo-100 rounded-2xl p-8 text-center group-hover:bg-indigo-50 transition-colors">
                        <span id="edit-file-icon" class="text-3xl block mb-2">üì§</span>
                        <p id="edit-file-text" class="text-sm font-medium text-indigo-400">Click to replace study material (Optional)</p>
                    </div>
                </div>
            </div>

            <div class="pt-6 border-t border-indigo-50 flex items-center justify-between">
                <a href="{% url 'subjects:subject_detail' chapter.subject.id %}" class="text-gray-400 font-semibold hover:text-gray-600">Cancel</a>
                <button type="submit" class="bg-[#6C5DD3] text-white px-10 py-4 rounded-[1.5rem] font-bold shadow-xl shadow-indigo-100 hover:bg-[#5b4eb3] transition-all transform hover:-translate-y-1">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const fileInput = document.getElementById('edit-file-input');
    const fileText = document.getElementById('edit-file-text');
    const fileIcon = document.getElementById('edit-file-icon');

    fileInput.addEventListener('change', function() {
        if (fileInput.files.length > 0) {
   
            fileText.innerText = 'New file selected: ' + fileInput.files[0].name;
            fileText.classList.replace('text-indigo-400', 'text-green-500');
        }
    });
</script>
{% endblock %}